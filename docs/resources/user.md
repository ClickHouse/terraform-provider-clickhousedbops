---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "clickhousedbops_user Resource - clickhousedbops"
subcategory: ""
description: |-
  Manages a ClickHouse user with dual-path password field support for different Terraform/OpenTofu versions.
---

# clickhousedbops_user (Resource)

Manages a ClickHouse user with dual-path password field support for different Terraform/OpenTofu versions.

## Example Usage

```terraform
# Basic user creation example with modern write-only password field (Terraform 1.11+)
resource "clickhousedbops_user" "john" {
  cluster_name = "cluster"
  name         = "john"
  
  # Modern approach: Write-only password field (recommended for Terraform 1.11+)
  # Password hash is never stored in Terraform state for enhanced security
  password_sha256_hash_wo         = sha256("secure_password_123")
  password_sha256_hash_wo_version = 1
}

# Alternative: Legacy compatibility example for Terraform <1.11 and OpenTofu
# Uncomment this resource and comment the one above if using older Terraform or OpenTofu
/*
resource "clickhousedbops_user" "john_legacy" {
  cluster_name = "cluster"
  name         = "john"
  
  # Legacy approach: Sensitive field stored encrypted in state
  # Use this for Terraform <1.11 or OpenTofu compatibility
  password_sha256_hash            = sha256("secure_password_123")
  password_sha256_hash_wo_version = 1
}
*/

# Best practice: Use variables for password management
variable "user_password" {
  description = "Password for ClickHouse user"
  type        = string
  sensitive   = true
  # Set via environment variable: TF_VAR_user_password or terraform.tfvars
}

resource "clickhousedbops_user" "variable_example" {
  cluster_name = "cluster"
  name         = "variable_user"
  
  # Use variable instead of hardcoding password
  password_sha256_hash_wo         = sha256(var.user_password)
  password_sha256_hash_wo_version = 1
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Name of the user
- `password_sha256_hash_wo_version` (Number) Version of the password_sha256_hash_wo field. Bump this value to require a force update of the password on the user.

### Optional

> **NOTE**: [Write-only arguments](https://developer.hashicorp.com/terraform/language/resources/ephemeral#write-only-arguments) are supported in Terraform 1.11 and later.

- `cluster_name` (String) Name of the cluster to create the resource into. If omitted, resource will be created on the replica hit by the query.
This field must be left null when using a ClickHouse Cloud cluster.
When using a self hosted ClickHouse instance, this field should only be set when there is more than one replica and you are not using 'replicated' storage for user_directory.
- `password_sha256_hash` (String, Sensitive) SHA256 hash of the password to be set for the user (legacy compatibility, stored encrypted in state)
- `password_sha256_hash_wo` (String, [Write-only](https://developer.hashicorp.com/terraform/language/resources/ephemeral#write-only-arguments)) SHA256 hash of the password to be set for the user (Terraform 1.11+ only, not stored in state)

### Read-Only

- `id` (String) The system-assigned ID for the user

## Import

Import is supported using the following syntax:

```shell
# Users can be imported by specifying the ID.
# Find the ID of the user by checking system.users table.
# WARNING: imported users will be recreated during first 'terraform apply' because the password cannot be imported.
terraform import clickhousedbops_user.example xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

# It's also possible to import users using the username:

terraform import clickhousedbops_user.example username

# IMPORTANT: if you have a multi node cluster, you need to specify the cluster name!

terraform import clickhousedbops_user.example cluster:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
terraform import clickhousedbops_user.example cluster:username
```

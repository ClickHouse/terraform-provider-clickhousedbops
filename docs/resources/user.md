---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "clickhousedbops_user Resource - clickhousedbops"
subcategory: ""
description: |-
  You can use the clickhousedbops_user resource to create a user in a ClickHouse instance.
  Known limitations:
  Changing the password_sha256_hash_wo field alone does not have any effect. In order to change the password of a user, you also need to bump password_sha256_hash_wo_version field.Changing the user's password as described above will cause the database user to be deleted and recreated.When importing an existing user, the clickhousedbops_user resource will be lacking the password_sha256_hash_wo_version and thus the subsequent apply will need to recreate the database User in order to set a password.
---

# clickhousedbops_user (Resource)

You can use the `clickhousedbops_user` resource to create a user in a `ClickHouse` instance.

## Password Field Options

This resource supports two mutually exclusive password fields for different Terraform versions:

- **`password_sha256_hash_wo`** (Recommended, Terraform 1.11+): Write-only field that is not stored in state for enhanced security
- **`password_sha256_hash`** (Legacy compatibility): Sensitive field stored encrypted in state for Terraform <1.11 and OpenTofu compatibility

You must specify exactly one of these fields. If both are specified, validation will fail.

Known limitations:

- Changing password fields alone does not have any effect. In order to change the password of a user, you also need to bump `password_sha256_hash_wo_version` field.
- Changing the user's password as described above will cause the database user to be deleted and recreated.
- When importing an existing user, the `clickhousedbops_user` resource will be lacking the `password_sha256_hash_wo_version` and thus the subsequent apply will need to recreate the database User in order to set a password.
- The `password_sha256_hash_wo_version` field applies to both password field options.

## Example Usage

### Terraform 1.11+ (Recommended - WriteOnly)

```terraform
resource "clickhousedbops_user" "john" {
  cluster_name = "cluster"
  name = "john"
  # You'll want to generate the password and feed it here instead of hardcoding.
  password_sha256_hash_wo = sha256("test")
  password_sha256_hash_wo_version = 4
}
```

### Legacy Compatibility (Terraform <1.11, OpenTofu)

```terraform
resource "clickhousedbops_user" "john_legacy" {
  cluster_name = "cluster"
  name = "john"
  # You'll want to generate the password and feed it here instead of hardcoding.
  password_sha256_hash = sha256("test")
  password_sha256_hash_wo_version = 4
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Name of the user
- `password_sha256_hash_wo_version` (Number) Version of the password field. Bump this value to require a force update of the password on the user.
- One of the following password fields (mutually exclusive):
  - `password_sha256_hash_wo` (String, [Write-only](https://developer.hashicorp.com/terraform/language/resources/ephemeral#write-only-arguments)) SHA256 hash of the password to be set for the user (Terraform 1.11+ only, not stored in state)
  - `password_sha256_hash` (String, Sensitive) SHA256 hash of the password to be set for the user (legacy compatibility, stored encrypted in state)

> **NOTE**: [Write-only arguments](https://developer.hashicorp.com/terraform/language/resources/ephemeral#write-only-arguments) are supported in Terraform 1.11 and later. For older versions or OpenTofu, use the `password_sha256_hash` field instead.

### Optional

- `cluster_name` (String) Name of the cluster to create the resource into. If omitted, resource will be created on the replica hit by the query.
This field must be left null when using a ClickHouse Cloud cluster.
When using a self hosted ClickHouse instance, this field should only be set when there is more than one replica and you are not using 'replicated' storage for user_directory.

### Read-Only

- `id` (String) The system-assigned ID for the user

## Import

Import is supported using the following syntax:

```shell
# Users can be imported by specifying the ID.
# Find the ID of the user by checking system.users table.
# WARNING: imported users will be recreated during first 'terraform apply' because the password cannot be imported.
terraform import clickhousedbops_user.example xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

# It's also possible to import users using the username:

terraform import clickhousedbops_user.example username

# IMPORTANT: if you have a multi node cluster, you need to specify the cluster name!

terraform import clickhousedbops_user.example cluster:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
terraform import clickhousedbops_user.example cluster:username
```
